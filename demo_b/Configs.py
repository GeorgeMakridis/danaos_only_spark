from pyspark.sql.types import StructType, StructField, LongType, TimestampType, DoubleType, IntegerType

INPUT_PATH = 'input/'
PREDICT_TIME = "00:03"
# TRAIN_TIME = "00:00:03"
TRAIN_TIME = ":03"

LSTM_SEQUENCE_LENGTH = 100
LSTM_EPOCHS = 2
LSTM_BATCH_SIZE = 100

CLIP_DICT = {'airCoolerCWInLETPress': [0.0, 3.4],
                     'scavAirFireDetTempNo1': [19, 120],
                     'scavAirFireDetTempNo2': [19, 120],
                     'scavAirFireDetTempNo3': [19, 120],
                     'scavAirFireDetTempNo4': [19, 120],
                     'scavAirFireDetTempNo5': [19, 120],
                     'scavAirFireDetTempNo6': [19, 120],
                     'scavAirFireDetTempNo7': [19, 120],
                     'scavAirFireDetTempNo8': [19, 120],
                     'scavAirFireDetTempNo9': [19, 120],
                     'scavAirFireDetTempNo10': [19, 120],
                     'cfWInPress': [1.5, 4.82],
                     'controlAirPress': [3.5, 7.52],
                     'foInPress': [0.35, 12],
                     'foInTemp': [27.7, 157],
                     'jcfWInTempLow': [29, 128],
                     'cylExhGasOutTempNo1': [0, 431],
                     'cylExhGasOutTempNo2': [0, 431],
                     'cylExhGasOutTempNo3': [0, 431],
                     'cylExhGasOutTempNo4': [0, 431],
                     'cylExhGasOutTempNo5': [0, 431],
                     'cylExhGasOutTempNo6': [0, 431],
                     'cylExhGasOutTempNo7': [0, 431],
                     'cylExhGasOutTempNo8': [0, 431],
                     'cylExhGasOutTempNo9': [0, 431],
                     'cylExhGasOutTempNo10': [0, 431],
                     'cylJCFWOutTempNo1': [16, 95],
                     'cylJCFWOutTempNo2': [16, 95],
                     'cylJCFWOutTempNo3': [16, 95],
                     'cylJCFWOutTempNo4': [16, 95],
                     'cylJCFWOutTempNo5': [16, 95],
                     'cylJCFWOutTempNo6': [16, 95],
                     'cylJCFWOutTempNo7': [16, 95],
                     'cylJCFWOutTempNo8': [16, 95],
                     'cylJCFWOutTempNo9': [16, 95],
                     'cylJCFWOutTempNo10': [16, 95],
                     'cylPistonCOOutTempNo1': [40, 60],
                     'cylPistonCOOutTempNo2': [40, 60],
                     'cylPistonCOOutTempNo3': [40, 60],
                     'cylPistonCOOutTempNo4': [40, 60],
                     'cylPistonCOOutTempNo5': [40, 60],
                     'cylPistonCOOutTempNo6': [40, 60],
                     'cylPistonCOOutTempNo7': [40, 60],
                     'cylPistonCOOutTempNo8': [40, 60],
                     'cylPistonCOOutTempNo9': [40, 60],
                     'cylPistonCOOutTempNo10': [40, 60],
                     'tcExhGasInTempNo1': [20, 480],
                     'tcExhGasInTempNo2': [20, 480],
                     'tcExhGasInTempNo3': [20, 480],
                     'tcExhGasOutTempNo1': [20, 480],
                     'tcExhGasOutTempNo2': [20, 480],
                     'tcExhGasOutTempNo3': [20, 480],
                     'tcLOInLETPressNo1': [0.11, 2.1],
                     'tcLOInLETPressNo2': [0.11, 2.1],
                     'tcLOInLETPressNo3': [0.11, 2.1],
                     'tcRPMNo1': [0.0, 25331],
                     'tcRPMNo2': [0.0, 25331],
                     'tcRPMNo3': [0.0, 25331],
                     'scavAirInLetPress': [0.0, 3.5],
                     'scavAirReceiverTemp': [40, 150],
                     'startAirPress': [2, 30],
                     'mainLOInLetPress': [2, 3.5],
                     'foTemperature': [43, 115],
                     'coolingWOutLETTempNo1': [20, 145],
                     'coolingWOutLETTempNo2': [20, 145],
                     'coolingWOutLETTempNo3': [20, 145],
                     'foVolConsumption': [0.0, 150],
                     'speed_overground' : [0.0, 28]
                     }

schema_mes = StructType([StructField("vessel_code", LongType(), True),
                             StructField("datetime", TimestampType(), True),
                             StructField("airCoolerCWInLETPress", DoubleType(), True),
                             StructField("scavAirFireDetTempNo1", DoubleType(), True),
                             StructField("scavAirFireDetTempNo2", DoubleType(), True),
                             StructField("scavAirFireDetTempNo3", DoubleType(), True),
                             StructField("scavAirFireDetTempNo4", DoubleType(), True),
                             StructField("scavAirFireDetTempNo5", DoubleType(), True),
                             StructField("scavAirFireDetTempNo6", DoubleType(), True),
                             StructField("scavAirFireDetTempNo7", DoubleType(), True),
                             StructField("scavAirFireDetTempNo8", DoubleType(), True),
                             StructField("scavAirFireDetTempNo9", DoubleType(), True),
                             StructField("scavAirFireDetTempNo10", DoubleType(), True),
                             StructField("scavAirFireDetTempNo11", DoubleType(), True),
                             StructField("scavAirFireDetTempNo12", DoubleType(), True),
                             StructField("coolerCWinTemp", DoubleType(), True),
                             StructField("cfWInPress", DoubleType(), True),
                             StructField("controlAirPress", DoubleType(), True),
                             StructField("cylLoTemp", DoubleType(), True),
                             StructField("exhVVSpringAirInPress", DoubleType(), True),
                             StructField("foFlow", DoubleType(), True),
                             StructField("foInPress", DoubleType(), True),
                             StructField("foInTemp", DoubleType(), True),
                             StructField("hfoViscocityHighLow", DoubleType(), True),
                             StructField("hpsBearingTemp", DoubleType(), True),
                             StructField("jcfWInTempLow", DoubleType(), True),
                             StructField("cylExhGasOutTempNo1", DoubleType(), True),
                             StructField("cylExhGasOutTempNo2", DoubleType(), True),
                             StructField("cylExhGasOutTempNo3", DoubleType(), True),
                             StructField("cylExhGasOutTempNo4", DoubleType(), True),
                             StructField("cylExhGasOutTempNo5", DoubleType(), True),
                             StructField("cylExhGasOutTempNo6", DoubleType(), True),
                             StructField("cylExhGasOutTempNo7", DoubleType(), True),
                             StructField("cylExhGasOutTempNo8", DoubleType(), True),
                             StructField("cylExhGasOutTempNo9", DoubleType(), True),
                             StructField("cylExhGasOutTempNo10", DoubleType(), True),
                             StructField("cylExhGasOutTempNo11", DoubleType(), True),
                             StructField("cylExhGasOutTempNo12", DoubleType(), True),
                             StructField("cylJCFWOutTempNo1", DoubleType(), True),
                             StructField("cylJCFWOutTempNo2", DoubleType(), True),
                             StructField("cylJCFWOutTempNo3", DoubleType(), True),
                             StructField("cylJCFWOutTempNo4", DoubleType(), True),
                             StructField("cylJCFWOutTempNo5", DoubleType(), True),
                             StructField("cylJCFWOutTempNo6", DoubleType(), True),
                             StructField("cylJCFWOutTempNo7", DoubleType(), True),
                             StructField("cylJCFWOutTempNo8", DoubleType(), True),
                             StructField("cylJCFWOutTempNo9", DoubleType(), True),
                             StructField("cylJCFWOutTempNo10", DoubleType(), True),
                             StructField("cylJCFWOutTempNo11", DoubleType(), True),
                             StructField("cylJCFWOutTempNo12", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo1", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo2", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo3", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo4", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo5", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo6", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo7", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo8", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo9", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo10", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo11", DoubleType(), True),
                             StructField("cylPistonCOOutTempNo12", DoubleType(), True),
                             StructField("tcExhGasInTempNo1", DoubleType(), True),
                             StructField("tcExhGasInTempNo2", DoubleType(), True),
                             StructField("tcExhGasInTempNo3", DoubleType(), True),
                             StructField("tcExhGasInTempNo4", DoubleType(), True),
                             StructField("tcExhGasOutTempNo1", DoubleType(), True),
                             StructField("tcExhGasOutTempNo2", DoubleType(), True),
                             StructField("tcExhGasOutTempNo3", DoubleType(), True),
                             StructField("tcExhGasOutTempNo4", DoubleType(), True),
                             StructField("tcLOInLETPressNo1", DoubleType(), True),
                             StructField("tcLOInLETPressNo2", DoubleType(), True),
                             StructField("tcLOInLETPressNo3", DoubleType(), True),
                             StructField("tcLOInLETPressNo4", DoubleType(), True),
                             StructField("tcLOOutLETTempNo1", DoubleType(), True),
                             StructField("tcLOOutLETTempNo2", DoubleType(), True),
                             StructField("tcLOOutLETTempNo3", DoubleType(), True),
                             StructField("tcLOOutLETTempNo4", DoubleType(), True),
                             StructField("tcRPMNo1", DoubleType(), True),
                             StructField("tcRPMNo2", DoubleType(), True),
                             StructField("tcRPMNo3", DoubleType(), True),
                             StructField("tcRPMNo4", DoubleType(), True),
                             StructField("orderRPMBridgeLeverer", DoubleType(), True),
                             StructField("rpm", DoubleType(), True),
                             StructField("scavAirInLetPress", DoubleType(), True),
                             StructField("scavAirReceiverTemp", DoubleType(), True),
                             StructField("startAirPress", DoubleType(), True),
                             StructField("thrustPadTemp", DoubleType(), True),
                             StructField("mainLOInLetPress", DoubleType(), True),
                             StructField("mainLOInTemp", DoubleType(), True),
                             StructField("foTemperature", DoubleType(), True),
                             StructField("foTotVolume", DoubleType(), True),
                             StructField("power", DoubleType(), True),
                             StructField("scavengeAirPressure", DoubleType(), True),
                             StructField("torque", DoubleType(), True),
                             StructField("coolingWOutLETTempNo1", DoubleType(), True),
                             StructField("coolingWOutLETTempNo2", DoubleType(), True),
                             StructField("coolingWOutLETTempNo3", DoubleType(), True),
                             StructField("coolingWOutLETTempNo4", DoubleType(), True),
                             StructField("foVolConsumption", DoubleType(), True),
                             StructField("foConsumption", DoubleType(), True),
                             StructField("foID", DoubleType(), True)])

schema_vds = StructType([
    StructField("vessel_code", IntegerType(), True),
    StructField("datetime", TimestampType(), True),
    StructField("power", DoubleType(), True),
    StructField("apparent_wind_speed", DoubleType(), True),
    StructField("speed_overground", DoubleType(), True),
    StructField("stw_long", DoubleType(), True),
    StructField("stw_trans", DoubleType(), True),
    StructField("rpm", DoubleType(), True),
    StructField("apparent_wind_angle", DoubleType(), True),
    StructField("total_teus", DoubleType(), True),
    StructField("total_feus", DoubleType(), True),
    StructField("cons_ifo_static_counter", DoubleType(), True),
    StructField("port_mid_draft", DoubleType(), True),
    StructField("stbd_mid_draft", DoubleType(), True),
    StructField("draft_aft", DoubleType(), True),
    StructField("draft_fore", DoubleType(), True),
    StructField("stw", DoubleType(), True),
    StructField("equivalent_teus", DoubleType(), True),
    StructField("mid_draft", DoubleType(), True),
    # StructField("trim", DoubleType(), True),
    StructField("latitude", DoubleType(), True),
    StructField("longitude", DoubleType(), True),
    StructField("cons_ifo_static1_counter", DoubleType(), True),
    StructField("wind_speed", DoubleType(), True),
    StructField("wind_ucomp", DoubleType(), True),
    StructField("wind_vcomp", DoubleType(), True),
    StructField("wind_wave_dir", DoubleType(), True),
    StructField("wind_wave_height", DoubleType(), True),
    StructField("wind_wave_mean_period", DoubleType(), True),
    StructField("current_ucomp", DoubleType(), True),
    StructField("current_vcomp", DoubleType(), True),
    StructField("relative_humidity", DoubleType(), True),
    StructField("primary_wave_dir", DoubleType(), True),
    StructField("primary_wave_length", DoubleType(), True),
    StructField("primary_wave_mean_period", DoubleType(), True),
    StructField("swell_wave_dir", DoubleType(), True),
    StructField("swell_wave_height", DoubleType(), True),
    StructField("swell_wave_mean_period", DoubleType(), True),
    StructField("air_temperature", DoubleType(), True),
    StructField("comb_wind_swell_wave_height", DoubleType(), True),
    StructField("direction", DoubleType(), True)
])